module.exports = Plugin;

function Plugin(db) {
	return {
		define: function(Model) {
			Model.settings.set("pagination.perpage", 20);

			Model.page = function(n, cb) {
				var perpage = Model.settings.get("pagination.perpage");
				var offset = (n - 1) * perpage
				return cb(null, offset)
			};

			Model.pages = function(cb) {
				Model.count(function(err, count) {
					if (err) {
						return cb(err);
					}

					return cb(null, Math.ceil(count / Model.settings.get("pagination.perpage")));
				});
			};
		}
	};
}